<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="Javascript30 challenge 2 - CSS Clock">
  <title>CSS Clock</title>

  <!-- LINK STYLESHEETS -->
  <link rel="stylesheet" href="../../assets-shared/css/fonts.css">
  <link rel="stylesheet" href="../../assets-shared/css/buttons.css">
  <link rel="stylesheet" href="../../assets-shared/css/basics.css">
</head>

<body>
  <div class="container">

    <div id="digital-clock" class="flex justify-center align-center"></div>

    <div class="clock">
      <div id="sec" class="clock-handler"></div>
      <div id="min" class="clock-handler"></div>
      <div id="hour" class="clock-handler"></div>
    </div>

    <div id="bttn-back" class="flex justify-center">
      <a class="center block bttn bttn-round">BACK<a>
    </div>
  </div>
  <!-- LOAD JAVASCRIPS AFTER PAGELOAD -->
  <script src="../../assets-shared/js/buttons.js"></script>
</body>
</html>

<!-- INLINE STYLE -->
<style>
  #bttn-back {
    margin: 20px;
  }
  #digital-clock > h1{
    font-weight: 400;
    font-size: 80px;
    margin: 20px;
  }
  .clock {
    border: 30px solid rgba(0,0,0,0.72);
    width: 300px;
    height: 300px;
    margin: 50px auto;
    border-radius: 50%;
    transition: all 0.2s ease;
    position: relative;
  }.clock:hover {
    border: 30px solid rgba(0,0,0,0.9);
  }
  .clock-handler {
    position: absolute;
    border-radius: 5px;
    background-color: black;
    transform-origin: 100%;
    transform: rotate(90deg);
    transition: all 1s ease;
  }
  #sec {
    background-color: red;
    height: 6px;
    width: 145px;
    top: 147px; /* take width of 6 px into account! 150-(6/2) = 147*/
    left: 5px; /* substract height from 150! => 150-145 = 5px*/
    transition-timing-function: linear;
  }
  #min {
    height: 14px;
    width: 135px;
    top: 143px; /* take width of 14 px into account! 150-(width/2) = 143*/
    left: 15px; /* substract height from 150! => 150-145 = 5px*/
  }
  #hour {
    height: 22px;
    width: 82px;
    top: 139px; /* take width of 21 px into account! 150-(22/2) = 139*/
    left: 68px; /* */
  }
</style>

<!-- INLINE SCRIPT -->
<script>
  const initializeClock = () => {
    const currentDate = new Date();
    setDigitalClock();
    degreeSec  +=  currentDate.getSeconds() * 6;
    degreeMin  +=  currentDate.getMinutes() * 6;
    degreeHour += (currentDate.getHours() % 12) * 5 * 6;
    updateHandlers();
  }

  const updateClock = () => {
    setDigitalClock();
    degreeSec  += (360 / 60);
    degreeMin  += (360 / 60 / 60);
    degreeHour += (360 / 12 / 60 / 60);
    updateHandlers();
    console.log(`${degreeHour.toFixed(2)} deg | ${degreeMin.toFixed(2)} deg | ${degreeSec.toFixed(2)} deg`);
  }

  const updateHandlers = () => {
    setHandler(secHandler, degreeSec);
    setHandler(minHandler, degreeMin);
    setHandler(hourHandler, degreeHour);
  }

  const setDigitalClock = () => {
    const currentDate = new Date();
    const now = {
      sec: formatDigit(currentDate.getSeconds()),
      min: formatDigit(currentDate.getMinutes()),
      hour: formatDigit(currentDate.getHours())
    }
    digitalClock.innerHTML = `<h1>${now.hour}:${now.min}:${now.sec}</h1>`;
  }
  // HELPER FUNCTION
  const formatDigit = num => (num.toString().length < 2 ? "0"+num : num).toString();
  const setHandler = (handler, degree) => handler.style.transform = `rotate(${degree}deg)`;

  // get DOM elements
  const digitalClock = document.getElementById('digital-clock');
  const secHandler = document.getElementById('sec');
  const minHandler = document.getElementById('min');
  const hourHandler = document.getElementById('hour');

  // start script
  let degreeSec  = 90;
  let degreeMin  = 90;
  let degreeHour = 90;
  initializeClock();
  setInterval(updateClock, 1000);
</script>
