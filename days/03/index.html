<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="Javascript30 challenge 3 - CSS Variables">
  <title>CSS Variables</title>

  <!-- LINK STYLESHEETS -->
  <link rel="stylesheet" href="../../assets-shared/css/fonts.css">
  <link rel="stylesheet" href="../../assets-shared/css/buttons.css">
  <link rel="stylesheet" href="../../assets-shared/css/basics.css">
</head>

<body>
  <div style="display: flex;">

    <div>
      <img class="image-left" src="" alt="">
    </div>

    <div class="controller">
      <h1 class="center">Image <span class="hl">Editor</span></h1>
      <p class="text-medium justify">
        Manipulating CSS Variables with JavaScript and AJAX. This is my personal solution to the <a href="https://javascript30.com/">Javascript30</a> challenge of day 3. The images are randomly fetched from the <a href="https://www.pexels.com/api/">Pexels API</a> and the quotes are taken from the <a href="https://www.forbes.com/sites/kevinkruse/2013/05/28/inspirational-quotes/#87965d46c7ac">Forbes magazine</a>.
      <p/>

      <p id="new-image-bttn" class="bttn bttn-round">NEW IMAGE</p>
      <p id="new-quote-bttn" class="bttn bttn-round">NEW QUOTE</p>

      <div class="controller-pair">
        <label for="spacing">Spacing:</label>
        <input id="spacing" type="range" name="spacing" min="10" max="200" value="10" data-sizing="px">
      </div>

      <div class="controller-pair">
        <label for="blur">Blur:</label>
        <input id="blur" type="range" name="blur" min="0" max="25" value="0" data-sizing="px">
      </div>

      <div class="controller-pair">
        <label for="base">Base Color</label>
        <input id="base" type="color" name="base" value="#7452ac">
      </div>

      <div class="flex justify-center">
        <a id="bttn-back" class="center block bttn bttn-round">BACK<a>
      </div>
    </div>

  </div>

  <!-- LOAD JAVASCRIPS AFTER PAGELOAD -->
  <script src="../../assets-shared/js/buttons.js"></script>
</body>
</html>

<!-- INLINE STYLE -->
<style>
  :root {
    --main-color: slateblue;
  }
  .bttn {
    background-color: var(--main-color);
  }
  p, h1, .controller-pair {
    margin-left: 40px;
    margin-right: 40px;
  }
  .image-left {
    height: 100vh;
    max-width: 70vw;
    transition: width 1s ease;
  }
  .toggled {
    height: 100vh;
    transition: width 1s ease;
  }
  .controller {
    height: 100vh;
    width: 500px;
  }
  .hl {
    color: var(--main-color);
  }
</style>

<!-- INLINE SCRIPT -->
<script>
  // get DOM Elements
  const imgLeft = document.querySelector('.image-left');
  const newImgBttn = document.getElementById('new-image-bttn');
  const newQuoteBttn = document.getElementById('new-quote-bttn');
  const inputs = document.querySelectorAll('input');
  // define variables
  let downloadingImage = new Image();

  // ADD EVENT LISTENERS
  // wait till picture is loaded before updating!
  downloadingImage.onload = function(){
    let targetWidth = this.width * (window.innerHeight / this.height);
    targetWidth = Math.min(targetWidth, window.innerWidth * 0.7);
    imgLeft.width = targetWidth;
    imgLeft.src = this.src;
    imgLeft.classList.add("toggled");
  };
  // add click events
  newImgBttn.addEventListener("click", () => randomImage());  // random image
  newQuoteBttn.addEventListener("click", () => randomQuote()); // random quote
  // add change events
  inputs.forEach((input) => {
    console.log(input);
    input.addEventListener("click", (e) => {
      console.log(e);
    });
  });

  // fetch data from API to get new image
  const randomImage = () => {
    fetch(`https://picsum.photos/v2/list?limit=100&page=${Math.ceil(Math.random()*9)}`)
    .then((resp) => resp.json())
    .then((data) => {
      if (data) {
        downloadingImage.src = data[Math.ceil(Math.random()*100)-1].download_url;
        imgLeft.classList.remove("toggled");
      }
    });
  }
  // generate new quotes onclick
  // randomly take a quota from JSON file
  const randomQuote = () => {
    console.log("geting random quote...");
  }
  // INITIALIZATION (SKRIPT START)
  randomImage();
  randomQuote();
</script>
